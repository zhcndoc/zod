---
title: è¿ç§»æŒ‡å—
description: "å®Œæ•´çš„å˜æ›´æ—¥å¿—å’Œä» Zod 3 å‡çº§åˆ° Zod 4 çš„è¿ç§»æŒ‡å—"
---

import { Callout } from "fumadocs-ui/components/callout";
import { Tabs, Tab } from "fumadocs-ui/components/tabs";

æœ¬è¿ç§»æŒ‡å—æ—¨åœ¨æŒ‰ç…§å½±å“ç¨‹åº¦ç”±é«˜åˆ°ä½ï¼Œåˆ—å‡º Zod 4 ä¸­çš„ç ´åæ€§æ›´æ”¹ã€‚è¦äº†è§£æœ‰å…³ Zod 4 æ€§èƒ½æå‡å’Œæ–°åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯» [ä»‹ç»æ–‡ç« ](/v4)ã€‚ 

{/* ä¸ºäº†ç»™ç”Ÿæ€ç³»ç»Ÿç•™å‡ºè¿ç§»æ—¶é—´ï¼ŒZod 4 å°†æœ€åˆä¸ Zod v3.25 åŒæ—¶å‘å¸ƒã€‚è¦ä½¿ç”¨ Zod 4ï¼Œè¯·å‡çº§åˆ° `zod@3.25.0` æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š */}

```
npm upgrade zod@^4.0.0
```

{/* Zod 4 å¯é€šè¿‡ `"/v4"` å­è·¯å¾„è·å–ï¼š

```ts
import * as z from "zod";
``` */}

Zod çš„è®¸å¤šè¡Œä¸ºå’Œ API å·²å˜å¾—æ›´åŠ ç›´è§‚å’Œä¸€è‡´ã€‚æœ¬æ–‡æ¡£ä¸­æè¿°çš„é‡å¤§å˜æ›´é€šå¸¸ä»£è¡¨äº† Zod ç”¨æˆ·çš„ä¸»è¦ç”Ÿæ´»è´¨é‡æ”¹è¿›ã€‚æˆ‘å¼ºçƒˆå»ºè®®æ‚¨ä»”ç»†é˜…è¯»æœ¬æŒ‡å—ã€‚

<Callout>
**æ³¨æ„** â€” Zod 3 å¯¼å‡ºäº†ä¸€äº›æœªè®°å½•çš„å‡†å†…éƒ¨å·¥å…·ç±»å‹å’Œå‡½æ•°ï¼Œè¿™äº›ä¸è¢«è§†ä¸ºå…¬å…± API çš„ä¸€éƒ¨åˆ†ã€‚å®ƒä»¬çš„æ›´æ”¹æœªåœ¨æ­¤å¤„è®°å½•ã€‚
</Callout>

<Callout>
**éå®˜æ–¹ä»£ç è¿ç§»å·¥å…·** â€” ç¤¾åŒºç»´æŠ¤äº†ä¸€ä¸ªä» Zod v3 å‡çº§è‡³ v4 çš„ä»£ç è½¬æ¢å·¥å…· [`zod-v3-to-v4`](https://github.com/nicoespeon/zod-v3-to-v4) å¯ä¾›ä½¿ç”¨ã€‚
</Callout>

## é”™è¯¯å®šåˆ¶

Zod 4 ç»Ÿä¸€æ•´åˆäº†é”™è¯¯å®šåˆ¶çš„ APIï¼Œç»Ÿä¸€ä½¿ç”¨å•ä¸€çš„ `error` å‚æ•°ã€‚ä¹‹å‰ Zod çš„é”™è¯¯å®šåˆ¶ API åˆ†æ•£ä¸”ä¸ä¸€è‡´ï¼ŒZod 4 ä¸­å·²æ¸…ç†ä¼˜åŒ–ã€‚

### åºŸå¼ƒ `message`

ç”¨ `error` å–ä»£ `message`ã€‚è™½ç„¶ `message` å‚æ•°ä»å—æ”¯æŒï¼Œä½†å·²åºŸå¼ƒã€‚

<Tabs groupId="error-message" items={["Zod 4", "Zod 3"]} persist>
<Tab value="Zod 4">
```ts
z.string().min(5, { error: "å¤ªçŸ­äº†ã€‚" });
```
</Tab>
<Tab value="Zod 3">
```ts
z.string().min(5, { message: "å¤ªçŸ­äº†ã€‚" });
```
</Tab>
</Tabs>

### ç§»é™¤ `invalid_type_error` å’Œ `required_error`

`invalid_type_error` / `required_error` å‚æ•°è¢«ç§»é™¤ã€‚å®ƒä»¬å‡ å¹´å‰åŒ†å¿™åŠ å…¥ï¼Œä½œä¸ºæ¯” `errorMap` æ›´ç®€æ´çš„é”™è¯¯å®šåˆ¶æ–¹å¼ï¼Œä½†å­˜åœ¨è¯¸å¤šé™·é˜±ï¼ˆä¸èƒ½ä¸ `errorMap` åŒæ—¶ä½¿ç”¨ï¼‰ï¼Œä¸”ä¸ Zod å®é™…çš„é—®é¢˜ä»£ç ä¸åŒ¹é…ï¼ˆä¸å­˜åœ¨ `required` é—®é¢˜ä»£ç ï¼‰ã€‚

è¿™äº›æƒ…å†µç°åœ¨å¯ç”¨æ–°çš„ `error` å‚æ•°æ¸…æ™°è¡¨è¾¾ã€‚

<Tabs groupId="error-type" items={["Zod 4", "Zod 3"]} persist>
<Tab value="Zod 4">
```ts
z.string({ 
  error: (issue) => issue.input === undefined 
    ? "è¿™æ˜¯å¿…å¡«å­—æ®µ" 
    : "ä¸æ˜¯å­—ç¬¦ä¸²" 
});
```
</Tab>
<Tab value="Zod 3">
```ts
z.string({ 
  required_error: "è¿™æ˜¯å¿…å¡«å­—æ®µ",
  invalid_type_error: "ä¸æ˜¯å­—ç¬¦ä¸²", 
});
```
</Tab>
</Tabs>

### ç§»é™¤ `errorMap`

è¯¥å‚æ•°åæ”¹ä¸º `error`ã€‚

é”™è¯¯æ˜ å°„å‡½æ•°ç°åœ¨ä¹Ÿå¯ä»¥ç›´æ¥è¿”å›æ™®é€šå­—ç¬¦ä¸²ï¼ˆè€Œé `{message: string}` å¯¹è±¡ï¼‰ã€‚å®ƒä»¬ä¹Ÿå¯ä»¥è¿”å› `undefined`ï¼ŒæŒ‡ç¤º Zod è½¬äº¤ç»™é“¾ä¸­ä¸‹ä¸€ä¸ªé”™è¯¯æ˜ å°„å¤„ç†ã€‚

<Tabs groupId="error-map" items={["Zod 4", "Zod 3"]} persist>
<Tab value="Zod 4">
```ts
z.string().min(5, {
  error: (issue) => {
    if (issue.code === "too_small") {
      return `å€¼å¿…é¡»å¤§äº ${issue.minimum}`
    }
  },
});
```
</Tab>
<Tab value="Zod 3">
```ts
z.string({
  errorMap: (issue, ctx) => {
    if (issue.code === "too_small") {
      return { message: `å€¼å¿…é¡»å¤§äº ${issue.minimum}` };
    }
    return { message: ctx.defaultError };
  },
});
```
</Tab>
</Tabs>

{/* ## `.safeParse()` 

å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œ`.safeParse()` å’Œ `.safeParseAsync()` è¿”å›çš„é”™è¯¯ä¸å†ç»§æ‰¿è‡ª `Error`ã€‚

```ts
const result = z.string().safeParse(12); 
result.error! instanceof Error; // => false
```

åœ¨ JavaScript ä¸­å®ä¾‹åŒ– `Error` å¯¹è±¡éå¸¸æ…¢ï¼Œå› ä¸ºå®ƒéœ€è¦å¿«ç…§è°ƒç”¨å †æ ˆã€‚è€Œ Zod çš„â€œå®‰å…¨â€è§£ææ–¹æ³•é¢„æœŸä½ ä¼šåœ¨è§£æç‚¹å¤„ç†é”™è¯¯ï¼Œå› æ­¤å®ä¾‹åŒ–çœŸæ­£çš„ `Error` å¯¹è±¡ä»·å€¼ä¸å¤§ã€‚

> å°æç¤ºï¼šåœ¨æ€§èƒ½æ•æ„Ÿçš„ä»£ç ä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ `.safeParse()` è€Œé `try/catch`ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`.parse()` å’Œ `.parseAsync()` æŠ›å‡ºçš„é”™è¯¯ä»ç»§æ‰¿è‡ª `Error`ã€‚é™¤äº†åŸå‹ä¸åŒï¼Œé”™è¯¯ç±»æ˜¯ç›¸åŒçš„ã€‚

```ts
try {
  z.string().parse(12);
} catch (err) {
  console.log(err instanceof Error); // => true
}
```
 */}

## `ZodError`
{/* 
### `.message` å˜åŒ–

ä¹‹å‰ï¼Œ`ZodError` çš„ `.message` å±æ€§æ˜¯ `.issues` æ•°ç»„çš„ JSON å­—ç¬¦ä¸²åŒ–å‰¯æœ¬ã€‚æ­¤åšæ³•å†—ä½™ã€å®¹æ˜“æ··æ·†ï¼Œä¸”ç¨æ˜¾æ»¥ç”¨ `.message` å±æ€§ã€‚å†åŠ ä¸Š [`Error` åŸå‹çš„å˜åŒ–](#safeparse) ï¼ˆä»¥åŠ Node.js å¯¹ `Error` å­ç±»ä¸å…¶ä»–å¯¹è±¡æ—¥å¿—å¤„ç†çš„ä¸ä¸€è‡´ï¼‰ï¼Œå¤šè¡Œ `.message` çš„æ—¥å¿—è¾“å‡ºå˜å¾—éš¾çœ‹ï¼š

```sh
$ tsx index.ts
ZodError {
  message: '[\n' +
    '  {\n' +
    '    "expected": "string",\n' +
    '    "code": "invalid_type",\n' +
    '    "path": [],\n' +
    '    "message": "æ— æ•ˆè¾“å…¥: æœŸæœ›å­—ç¬¦ä¸²ï¼Œæ”¶åˆ°æ•°å­—"\n' +
    '  }\n' +
    ']'
}
```

å› æ­¤ï¼Œ`.message` å±æ€§ç°åœ¨ä¸ºç©ºï¼Œ`.issues` æ•°ç»„è¢«æ ‡è®°ä¸ºå¯æšä¸¾ã€‚è¿™è®©é”™è¯¯æ—¥å¿—æ›´ä¸€è‡´ä¸”ç¾è§‚ï¼š

```sh
$ tsx index.ts
z.string().parse(234);

ZodError {
  issues: [
    {
      expected: 'string',
      code: 'invalid_type',
      path: [],
      message: 'æ— æ•ˆè¾“å…¥: æœŸæœ›å­—ç¬¦ä¸²ï¼Œæ”¶åˆ°æ•°å­—'
    }
  ]
}
```

Vitest é€šè¿‡ç‰¹æ®Šå¤„ç† `Error` å­ç±»ï¼Œå¿½ç•¥å¯æšä¸¾å±æ€§ã€‚ */}

### æ›´æ–°äº† issue æ ¼å¼

issue æ ¼å¼ç»è¿‡æ˜¾è‘—ç®€åŒ–ã€‚

```ts
import * as z from "zod"; // v4

type IssueFormats = 
  | z.core.$ZodIssueInvalidType
  | z.core.$ZodIssueTooBig
  | z.core.$ZodIssueTooSmall
  | z.core.$ZodIssueInvalidStringFormat
  | z.core.$ZodIssueNotMultipleOf
  | z.core.$ZodIssueUnrecognizedKeys
  | z.core.$ZodIssueInvalidValue
  | z.core.$ZodIssueInvalidUnion
  | z.core.$ZodIssueInvalidKey // æ–°å¢ï¼šç”¨äº z.record/z.map 
  | z.core.$ZodIssueInvalidElement // æ–°å¢ï¼šç”¨äº z.map/z.set
  | z.core.$ZodIssueCustom;
```

ä¸‹é¢æ˜¯ Zod 3 issue ç±»å‹å’Œå®ƒä»¬åœ¨ Zod 4 ä¸­å¯¹åº”ç±»å‹çš„åˆ—è¡¨ï¼š

```ts
import * as z from "zod"; // v3

export type IssueFormats =
  | z.ZodInvalidTypeIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueInvalidType
  | z.ZodTooBigIssue  // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueTooBig
  | z.ZodTooSmallIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueTooSmall
  | z.ZodInvalidStringIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueInvalidStringFormat
  | z.ZodNotMultipleOfIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueNotMultipleOf
  | z.ZodUnrecognizedKeysIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueUnrecognizedKeys
  | z.ZodInvalidUnionIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueInvalidUnion
  | z.ZodCustomIssue // â™»ï¸ é‡å‘½åä¸º z.core.$ZodIssueCustom
  | z.ZodInvalidEnumValueIssue // âŒ åˆå¹¶å…¥ z.core.$ZodIssueInvalidValue
  | z.ZodInvalidLiteralIssue // âŒ åˆå¹¶å…¥ z.core.$ZodIssueInvalidValue
  | z.ZodInvalidUnionDiscriminatorIssue // âŒ åœ¨ schema åˆ›å»ºæ—¶æŠ›å‡º Error
  | z.ZodInvalidArgumentsIssue // âŒ z.function ç›´æ¥æŠ›å‡º ZodError
  | z.ZodInvalidReturnTypeIssue // âŒ z.function ç›´æ¥æŠ›å‡º ZodError
  | z.ZodInvalidDateIssue // âŒ åˆå¹¶å…¥ invalid_type
  | z.ZodInvalidIntersectionTypesIssue // âŒ ç§»é™¤ï¼ˆæŠ›å‡ºæ™®é€š Errorï¼‰
  | z.ZodNotFiniteIssue // âŒ ä¸å†æ”¯æŒæ— é™å€¼ï¼ˆinvalid_typeï¼‰
```

è™½ç„¶æŸäº› Zod 4 çš„ issue ç±»å‹è¢«åˆå¹¶ã€ç§»é™¤æˆ–ä¿®æ”¹ï¼Œä½†æ¯ä¸ª issue åœ¨ç»“æ„ä¸ŠåŸºæœ¬ä¸ Zod 3 å¯¹åº”ç±»å‹ç›¸ä¼¼ï¼ˆå¤šæ•°æƒ…å†µä¸‹å®Œå…¨ç›¸åŒï¼‰ã€‚æ‰€æœ‰ issue ä¾ç„¶éµå¾ªä¸ Zod 3 ç›¸åŒçš„åŸºç¡€æ¥å£ï¼Œå› æ­¤å¤§å¤šæ•°å¸¸è§çš„é”™è¯¯å¤„ç†é€»è¾‘æ— éœ€ä¿®æ”¹ã€‚

```ts
export interface $ZodIssueBase {
  readonly code?: string;
  readonly input?: unknown;
  readonly path: PropertyKey[];
  readonly message: string;
}
```

### é”™è¯¯æ˜ å°„ä¼˜å…ˆçº§å˜åŒ–

é”™è¯¯æ˜ å°„çš„ä¼˜å…ˆçº§è°ƒæ•´å¾—æ›´ä¸€è‡´ã€‚å…·ä½“æ¥è¯´ï¼Œä¼ é€’ç»™ `.parse()` çš„é”™è¯¯æ˜ å°„ *ä¸å†* é«˜äº schema çº§åˆ«çš„é”™è¯¯æ˜ å°„ã€‚

```ts
const mySchema = z.string({ error: () => "Schema çº§åˆ«é”™è¯¯" });

// åœ¨ Zod 3 ä¸­
mySchema.parse(12, { error: () => "ä¸Šä¸‹æ–‡é”™è¯¯" }); // => "ä¸Šä¸‹æ–‡é”™è¯¯"

// åœ¨ Zod 4 ä¸­
mySchema.parse(12, { error: () => "ä¸Šä¸‹æ–‡é”™è¯¯" }); // => "Schema çº§åˆ«é”™è¯¯"
```

### åºŸå¼ƒ `.format()`

`ZodError` çš„ `.format()` æ–¹æ³•å·²åºŸå¼ƒã€‚è¯·æ”¹ç”¨é¡¶å±‚çš„ `z.treeifyError()` å‡½æ•°ã€‚æ›´å¤šä¿¡æ¯è¯·å‚é˜… [é”™è¯¯æ ¼å¼åŒ–æ–‡æ¡£](/error-formatting)ã€‚

### åºŸå¼ƒ `.flatten()`

`ZodError` çš„ `.flatten()` æ–¹æ³•åŒæ ·åºŸå¼ƒã€‚è¯·æ”¹ç”¨é¡¶å±‚çš„ `z.treeifyError()` å‡½æ•°ã€‚æ›´å¤šä¿¡æ¯è¯·å‚é˜… [é”™è¯¯æ ¼å¼åŒ–æ–‡æ¡£](/error-formatting)ã€‚

### ç§»é™¤ `.formErrors`

æ­¤ API ä¸ `.flatten()` å®Œå…¨ç›¸åŒï¼Œå†å²é—ç•™ä¸”æœªè®°å½•ã€‚

### åºŸå¼ƒ `.addIssue()` å’Œ `.addIssues()`

å¦‚æœ‰å¿…è¦ï¼Œè¯·ç›´æ¥å‘ `err.issues` æ•°ç»„æ¨å…¥æ–°é—®é¢˜ã€‚

```ts
myError.issues.push({ 
  // æ–°é—®é¢˜
});
```

{/* ## `.and()` ç§»é™¤

`ZodType` çš„ `.and()` æ–¹æ³•è¢«ç§»é™¤ï¼Œæ¨èä½¿ç”¨ `z.intersection(A, B)`ã€‚è¯¥æ–¹æ³•å¾ˆå°‘ä½¿ç”¨ï¼Œä¸”æ²¡å¤šå°‘ç†ç”±ä½¿ç”¨äº¤å‰ç±»å‹ã€‚`.and()` API ä¼šé˜»æ­¢æ‰“åŒ…å·¥å…· Tree-shaking `ZodIntersection`ï¼Œè€Œ `ZodIntersection` æ˜¯ä¸€ä¸ªç›¸å½“å¤§ä¸”å¤æ‚çš„ç±»ã€‚

```ts
z.object({ a: z.string() }).and(z.object({ b: z.number() })); // âŒ

// æ¨èä½¿ç”¨ z.intersection
z.intersection(z.object({ a: z.string() }), z.object({ b: z.number() })); // âœ…
// æˆ–å°½å¯èƒ½ä½¿ç”¨ .extend()
z.object({ a: z.string() }).extend(z.object({ b: z.number() })); // âœ…
``` */}

## `z.number()`

### ä¸å†æ”¯æŒæ— é™å€¼

`POSITIVE_INFINITY` å’Œ `NEGATIVE_INFINITY` ä¸å†è¢«è§†ä½œ `z.number()` çš„æœ‰æ•ˆå€¼ã€‚

### `.safe()` ä¸å†æ¥å—æµ®ç‚¹æ•°

åœ¨ Zod 3 ä¸­ï¼Œ`z.number().safe()` å·²åºŸå¼ƒã€‚ç°åœ¨å®ƒçš„è¡Œä¸ºä¸ `.int()` ç›¸åŒï¼ˆå‚è§ä¸‹æ–‡ï¼‰ï¼Œé‡è¦çš„æ˜¯å®ƒä¸å†æ¥å—æµ®ç‚¹æ•°ã€‚

### `.int()` åªæ¥å—å®‰å…¨æ•´æ•°

`z.number().int()` ä¸å†æ¥å—ä¸å®‰å…¨æ•´æ•°ï¼ˆè¶…å‡º `Number.MIN_SAFE_INTEGER` å’Œ `Number.MAX_SAFE_INTEGER` èŒƒå›´ï¼‰ã€‚ä½¿ç”¨è¶…å‡ºè¯¥èŒƒå›´çš„æ•´æ•°ä¼šå¼•å‘è‡ªåŠ¨èˆå…¥é”™è¯¯ã€‚ï¼ˆæ­¤å¤–ï¼Œä½ åº”è¯¥æ”¹ç”¨ `z.int()`ã€‚ï¼‰

## `z.string()` æ›´æ–°

### åºŸå¼ƒ `.email()` ç­‰æ–¹æ³•

å­—ç¬¦ä¸²æ ¼å¼ç°åœ¨è¡¨ç¤ºä¸º `ZodString` çš„ *å­ç±»*ï¼Œè€Œéç®€å•çš„å†…éƒ¨ refinementã€‚å› æ­¤ï¼Œè¿™äº› API å·²ç§»åŠ¨åˆ°é¡¶çº§ `z` å‘½åç©ºé—´ã€‚é¡¶çº§ API ä¹Ÿæ›´ç®€æ´ã€æ›´æ”¯æŒ Tree-shakingã€‚

```ts
z.email();
z.uuid();
z.url();
z.emoji();         // éªŒè¯å•ä¸ªè¡¨æƒ…ç¬¦å·å­—ç¬¦
z.base64();
z.base64url();
z.nanoid();
z.cuid();
z.cuid2();
z.ulid();
z.ipv4();
z.ipv6();
z.cidrv4();          // IP èŒƒå›´
z.cidrv6();          // IP èŒƒå›´
z.iso.date();
z.iso.time();
z.iso.datetime();
z.iso.duration();
```

åŸå…ˆçš„æ–¹æ³•å½¢å¼ï¼ˆ`z.string().email()`ï¼‰ä¾æ—§å­˜åœ¨ä¸”æ­£å¸¸å·¥ä½œï¼Œä½†å·²è¢«åºŸå¼ƒã€‚

```ts
z.string().email(); // âŒ åºŸå¼ƒ
z.email(); // âœ… 
```

### æ›´ä¸¥æ ¼çš„ `.uuid()`

`z.uuid()` ç°åœ¨æ ¹æ® RFC 9562/4122 è§„èŒƒæ›´ä¸¥æ ¼åœ°éªŒè¯ UUIDï¼›å…·ä½“æ¥è¯´ï¼Œå˜ä½“ä½å¿…é¡»æ˜¯ `10`ã€‚å¯¹äºæ›´å®½æ¾çš„â€œç±»ä¼¼ UUIDâ€éªŒè¯å™¨ï¼Œè¯·ä½¿ç”¨ `z.guid()`ã€‚

```ts
z.uuid(); // RFC 9562/4122 compliant UUID
z.guid(); // any 8-4-4-4-12 hex pattern
```

### `.base64url()` ä¸æ”¯æŒå¡«å……å­—ç¬¦

`z.base64url()`ï¼ˆåŸ `z.string().base64url()`ï¼‰ä¸å†å…è®¸å¡«å……å­—ç¬¦ã€‚é€šå¸¸ base64url å­—ç¬¦ä¸²åº”æ— å¡«å……ä¸” URL å®‰å…¨ã€‚

### ç§»é™¤ `z.string().ip()`

æ­¤æ–¹æ³•è¢«æ‹†åˆ†ä¸º `.ipv4()` å’Œ `.ipv6()` ä¸¤ä¸ªæ–¹æ³•ã€‚è‹¥éœ€æ”¯æŒä¸¤è€…ï¼Œç”¨ `z.union()` åˆå¹¶ã€‚

```ts
z.string().ip() // âŒ
z.ipv4() // âœ…
z.ipv6() // âœ…
```

### æ›´æ–° `z.string().ipv6()`

éªŒè¯ç°åœ¨ä½¿ç”¨ `new URL()` æ„é€ å‡½æ•°ï¼Œæ¯”ä¹‹å‰çš„æ­£åˆ™è¡¨è¾¾å¼æ–¹æ³•æ›´ç¨³å¥ã€‚ä¹‹å‰é€šè¿‡éªŒè¯çš„ä¸€äº›æ— æ•ˆå€¼ç°åœ¨å¯èƒ½å¤±è´¥ã€‚

### ç§»é™¤ `z.string().cidr()`

ç±»ä¼¼åœ°ï¼Œæ‹†åˆ†ä¸º `.cidrv4()` å’Œ `.cidrv6()` ä¸¤ä¸ªæ–¹æ³•ã€‚è‹¥éœ€åŒæ—¶æ”¯æŒï¼Œä½¿ç”¨ `z.union()`ã€‚

```ts
z.string().cidr() // âŒ
z.cidrv4() // âœ…
z.cidrv6() // âœ…
```

## `z.coerce` æ›´æ–°

æ‰€æœ‰ `z.coerce` æ¨¡å¼çš„è¾“å…¥ç±»å‹ç°åœ¨ä¸º `unknown`ã€‚

```ts
const schema = z.coerce.string();
type schemaInput = z.input<typeof schema>;

// Zod 3: string;
// Zod 4: unknown;
```

## `.default()` æ›´æ–°

`.default()` çš„è¡Œä¸ºæœ‰ç»†å¾®å˜åŒ–ã€‚è‹¥è¾“å…¥ä¸º `undefined`ï¼Œ`ZodDefault` ä¼šçŸ­è·¯è§£ææµç¨‹å¹¶è¿”å›é»˜è®¤å€¼ã€‚é»˜è®¤å€¼å¿…é¡»å¯èµ‹ç»™ *è¾“å‡ºç±»å‹*ã€‚

```ts
const schema = z.string()
  .transform(val => val.length)
  .default(0); // åº”ä¸ºæ•°å­—
schema.parse(undefined); // => 0
```

åœ¨ Zod 3 ä¸­ï¼Œ`.default()` æœŸæœ›å€¼ç¬¦åˆ *è¾“å…¥ç±»å‹*ï¼Œ`ZodDefault` ä¼šè§£æé»˜è®¤å€¼ï¼Œè€ŒéçŸ­è·¯ã€‚å› æ­¤é»˜è®¤å€¼å¿…é¡»èµ‹ç»™ *è¾“å…¥ç±»å‹*ã€‚

```ts
// Zod 3
const schema = z.string()
  .transform(val => val.length)
  .default("tuna");
schema.parse(undefined); // => 4
```

ä¸ºé‡ç°æ—§è¡Œä¸ºï¼ŒZod æä¾›äº† `.prefault()` æ–° APIï¼Œæ„ä¸ºâ€œé¢„è§£æé»˜è®¤å€¼â€ã€‚

```ts
// Zod 3
const schema = z.string()
  .transform(val => val.length)
  .prefault("tuna");
schema.parse(undefined); // => 4
```

## `z.object()`

### åœ¨å¯é€‰å­—æ®µä¸­åº”ç”¨çš„é»˜è®¤å€¼

å³ä½¿åœ¨å¯é€‰å­—æ®µä¸­ï¼Œæ‚¨å±æ€§å†…çš„é»˜è®¤å€¼ä¹Ÿä¼šè¢«åº”ç”¨ã€‚è¿™æ›´ç¬¦åˆé¢„æœŸï¼Œå¹¶è§£å†³äº† Zod 3 ä¸­é•¿æœŸå­˜åœ¨çš„å¯ç”¨æ€§é—®é¢˜ã€‚è¿™æ˜¯ä¸€ä¸ªå¾®å¦™çš„å˜åŒ–ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¾èµ–äºé”®å­˜åœ¨ç­‰çš„ä»£ç è·¯å¾„å‡ºç°é—®é¢˜ã€‚

```ts
const schema = z.object({
  a: z.string().default("tuna").optional(),
});

schema.parse({});
// Zod 4: { a: "tuna" }
// Zod 3: {}
```

### åºŸå¼ƒ `.strict()` å’Œ `.passthrough()`

è¿™äº›æ–¹æ³•ä¸€èˆ¬ä¸å†å¿…éœ€ã€‚è¯·ä½¿ç”¨é¡¶çº§çš„ `z.strictObject()` å’Œ `z.looseObject()` å‡½æ•°ä»£æ›¿ã€‚

```ts
// Zod 3
z.object({ name: z.string() }).strict();
z.object({ name: z.string() }).passthrough();

// Zod 4
z.strictObject({ name: z.string() });
z.looseObject({ name: z.string() });
```

> è¿™äº›æ–¹æ³•ä»å¯ç”¨ä»¥å…¼å®¹æ—§ä»£ç ï¼Œä¸”ä¸ä¼šè¢«ç§»é™¤ï¼Œè¢«è§†ä¸ºé—ç•™ APIã€‚

### åºŸå¼ƒ `.strip()`

è¯¥æ–¹æ³•æœ¬èº«ä»·å€¼ä¸å¤§ï¼Œä¸”æ˜¯ `z.object()` çš„é»˜è®¤è¡Œä¸ºã€‚è‹¥éœ€å°†ä¸¥æ ¼å¯¹è±¡è½¬æ¢ä¸ºâ€œæ™®é€šâ€å¯¹è±¡ï¼Œä½¿ç”¨ `z.object(A.shape)` å³å¯ã€‚

### ç§»é™¤ `.nonstrict()`

æ­¤æ—§åˆ«åå¯¹åº” `.strip()`ï¼Œæ—©å·²åºŸå¼ƒï¼Œç°åœ¨ç§»é™¤ã€‚

### ç§»é™¤ `.deepPartial()`

åœ¨ Zod 3 ä¸­æ—©å·²åºŸå¼ƒï¼ŒZod 4 å®Œå…¨ç§»é™¤ã€‚æ— ç›´æ¥æ›¿ä»£æ–¹æ¡ˆã€‚å…¶å®ç°å­˜åœ¨å¾ˆå¤šé™·é˜±ï¼Œä¸”ä¸€èˆ¬è¢«è§†ä¸ºåæ¨¡å¼ã€‚

### ä¿®æ”¹ `z.unknown()` å¯é€‰æ€§

`z.unknown()` å’Œ `z.any()` ç±»å‹åœ¨æ¨æ–­ç±»å‹ä¸­ä¸å†æ ‡è®°ä¸ºâ€œå¯¹è±¡é”®å¯é€‰â€ã€‚

```ts
const mySchema = z.object({
  a: z.any(),
  b: z.unknown()
});
// Zod 3: { a?: any; b?: unknown };
// Zod 4: { a: any; b: unknown };
```

### ä¸æ¨èä½¿ç”¨ `.merge()`

`ZodObject` ä¸Šçš„ `.merge()` æ–¹æ³•å·²è¢«ä¸æ¨èä½¿ç”¨ï¼Œå»ºè®®ä½¿ç”¨ `.extend()`ã€‚`.extend()` æ–¹æ³•æä¾›ç›¸åŒçš„åŠŸèƒ½ï¼Œé¿å…äº†ä¸¥æ ¼æ€§ç»§æ‰¿çš„æ¨¡ç³Šæ€§ï¼Œå¹¶ä¸”åœ¨ TypeScript ä¸­æ€§èƒ½æ›´å¥½ã€‚

```ts
// .merge (deprecated)
const ExtendedSchema = BaseSchema.merge(AdditionalSchema);

// .extend (recommended)
const ExtendedSchema = BaseSchema.extend(AdditionalSchema.shape);

// or use destructuring (best tsc performance)
const ExtendedSchema = z.object({
  ...BaseSchema.shape,
  ...AdditionalSchema.shape,
});
```

> **æ³¨æ„**ï¼šä¸ºäº†è·å¾—æ›´å¥½çš„ TypeScript æ€§èƒ½ï¼Œè€ƒè™‘ä½¿ç”¨å¯¹è±¡è§£æ„è€Œä¸æ˜¯ `.extend()`ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ [API æ–‡æ¡£](/api?id=extend)ã€‚

## `z.nativeEnum()` å·²å¼ƒç”¨

`z.nativeEnum()` å‡½æ•°ç°å·²å¼ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ `z.enum()`ã€‚`z.enum()` API å·²è¢«é‡è½½ä»¥æ”¯æŒç±»ä¼¼æšä¸¾çš„è¾“å…¥ã€‚

```ts
enum Color {
  Red = "red",
  Green = "green",
  Blue = "blue",
}

const ColorSchema = z.enum(Color); // âœ…
```

ä½œä¸º `ZodEnum` é‡æ„çš„ä¸€éƒ¨åˆ†ï¼Œä¸€äº›é•¿æœŸåºŸå¼ƒä¸”å†—ä½™çš„ç‰¹æ€§è¢«ç§»é™¤ã€‚è¿™äº›éƒ½ç›¸åŒä¸”ä»…å‡ºäºå†å²åŸå› å­˜åœ¨ã€‚

```ts
ColorSchema.enum.Red; // âœ… => "Red"ï¼ˆå®˜æ–¹ APIï¼‰
ColorSchema.Enum.Red; // âŒ å·²ç§»é™¤
ColorSchema.Values.Red; // âŒ å·²ç§»é™¤
```

## `z.array()`

### `.nonempty()` ç±»å‹å˜åŒ–

å…¶è¡Œä¸ºç°åœ¨ä¸ `z.array().min(1)` ç­‰åŒã€‚æ¨æ–­ç±»å‹ä¸å˜ã€‚

```ts
const NonEmpty = z.array(z.string()).nonempty();

type NonEmpty = z.infer<typeof NonEmpty>; 
// Zod 3: [string, ...string[]]
// Zod 4: string[]
```

æ—§è¡Œä¸ºç°åœ¨æ›´é€‚åˆç”¨ `z.tuple()` å’Œ â€œrestâ€ å‚æ•°è¡¨è¾¾ï¼Œå’Œ TypeScript ç±»å‹ç³»ç»Ÿæ›´è´´è¿‘ã€‚

```ts
z.tuple([z.string()], z.string());
// => [string, ...string[]]
```

## åºŸå¼ƒ `z.promise()`

æå°‘éœ€è¦ä½¿ç”¨ `z.promise()`ã€‚è‹¥è¾“å…¥å¯èƒ½æ˜¯ `Promise`ï¼Œè¯·å…ˆ `await` åå†ä½¿ç”¨ Zod è§£æã€‚

> è‹¥ä½ ç”¨ `z.promise` é…åˆ `z.function()` å®šä¹‰å¼‚æ­¥å‡½æ•°ï¼Œä¹Ÿä¸å†éœ€è¦ï¼Œè¯¦è§ä¸‹é¢çš„ [`ZodFunction`](#function) éƒ¨åˆ†ã€‚

## `z.function()`

`z.function()` çš„ç»“æœä¸å†æ˜¯ Zod æ¨¡å¼ï¼Œè€Œæ˜¯ç‹¬ç«‹çš„â€œå‡½æ•°å·¥å‚â€ï¼Œç”¨äºå®šä¹‰ç»è¿‡ Zod æ ¡éªŒçš„å‡½æ•°ã€‚API ä¹Ÿæœ‰å˜åŒ–ï¼›ä½ ç°åœ¨éœ€æå‰å®šä¹‰ `input` å’Œ `output` schemaï¼Œè€Œéä½¿ç”¨ `.args()` å’Œ `.returns()` æ–¹æ³•ã€‚

<Tabs groupId="lib" items={["Zod 4", "Zod 3"]} persist>
<Tab value="Zod 4">
```ts
const myFunction = z.function({
  input: [z.object({
    name: z.string(),
    age: z.number().int(),
  })],
  output: z.string(),
});

myFunction.implement((input) => {
  return `Hello ${input.name}, ä½  ${input.age} å²äº†ã€‚`;
});
```
</Tab>
<Tab value="Zod 3">
```ts
const myFunction = z.function()
  .args(z.object({
    name: z.string(),
    age: z.number().int(),
  }))
  .returns(z.string());

myFunction.implement((input) => {
  return `Hello ${input.name}, ä½  ${input.age} å²äº†ã€‚`;
});
```
</Tab>
</Tabs>

å¦‚æœä½ è¿«åˆ‡éœ€è¦ä¸€ä¸ªæ‹¥æœ‰å‡½æ•°ç±»å‹çš„ Zod æ¨¡å¼ï¼Œå¯ä»¥è€ƒè™‘[æ­¤è§£å†³æ–¹æ¡ˆ](https://github.com/colinhacks/zod/issues/4143#issuecomment-2845134912)ã€‚

### æ–°å¢ `.implementAsync()`

å®šä¹‰å¼‚æ­¥å‡½æ•°æ—¶ï¼Œä½¿ç”¨ `implementAsync()` æ›¿ä»£ `implement()`ã€‚

```ts
myFunction.implementAsync(async (input) => {
  return `Hello ${input.name}, ä½  ${input.age} å²äº†ã€‚`;
});
```

## `.refine()`

### å¿½ç•¥ç±»å‹è°“è¯

åœ¨ Zod 3 ä¸­ï¼Œä½œä¸ºæ ¡éªŒå‡½æ•°çš„ [ç±»å‹è°“è¯](https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates) å¯ç¼©å°æ¨¡å¼ç±»å‹ã€‚æ­¤è¡Œä¸ºæœªè®°å½•ä½†æ›¾æœ‰è®¨è®ºã€‚ç°å·²å–æ¶ˆã€‚

```ts
const mySchema = z.unknown().refine((val): val is string => {
  return typeof val === "string"
});

type MySchema = z.infer<typeof mySchema>; 
// Zod 3: `string`
// Zod 4: ä»ä¸º `unknown`
```

### ç§»é™¤ `ctx.path`

Zod æ–°çš„è§£ææ¶æ„ä¸å†ä¸»åŠ¨è®¡ç®— `path` æ•°ç»„ã€‚æ­¤æ”¹åŠ¨æ˜¯ Zod 4 å·¨å¤§æ€§èƒ½æå‡çš„å…³é”®ã€‚

```ts
z.string().superRefine((val, ctx) => {
  ctx.path; // âŒ ä¸å†æ”¯æŒ
});
```

### ç§»é™¤ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°çš„é‡è½½

è¯¥ä»¤äººå›°æ‰°çš„é‡è½½å·²ç§»é™¤ã€‚

```ts
const longString = z.string().refine(
  (val) => val.length > 10,
  (val) => ({ message: `${val} è¶…è¿‡10ä¸ªå­—ç¬¦` })
);
```

{/* ## `.superRefine()` å·²å¼ƒç”¨

`.superRefine()` æ–¹æ³•å·²è¢«å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨ `.check()`ã€‚`.check()` æ–¹æ³•æä¾›ç›¸åŒçš„åŠŸèƒ½ï¼Œå¹¶ä¸”å…·æœ‰æ›´ç®€æ´çš„ APIã€‚`.check()` æ–¹æ³•ä¹Ÿé€‚ç”¨äº Zod å’Œ Zod Mini æ¨¡å¼ã€‚

```ts
const UniqueStringArray = z.array(z.string()).check((ctx) => {
  if (ctx.value.length > 3) {
    ctx.issues.push({
      code: "too_big",
      maximum: 3,
      origin: "array",
      inclusive: true,
      message: "Too many items ğŸ˜¡",
      input: ctx.value
    });
  }

  if (ctx.value.length !== new Set(ctx.value).size) {
    ctx.issues.push({
      code: "custom",
      message: `No duplicates allowed.`,
      input: ctx.value
    });
  }
});
``` */}


## `z.ostring()` ç­‰å·²åˆ é™¤

æœªè®°å½•çš„ä¾¿åˆ©æ–¹æ³• `z.ostring()`ã€`z.onumber()` ç­‰å·²è¢«ç§»é™¤ã€‚è¿™äº›æ˜¯ç”¨äºå®šä¹‰å¯é€‰å­—ç¬¦ä¸²æ¨¡å¼çš„ç®€å†™æ–¹æ³•ã€‚

## `z.literal()`

### ç§»é™¤ `symbol` æ”¯æŒ

ç¬¦å·ä¸æ˜¯å­—é¢é‡å€¼ï¼Œä¸”ä¸èƒ½ç®€å•ç”¨ `===` æ¯”è¾ƒã€‚è¿™æ˜¯ Zod 3 ä¸­çš„ä¸€ä¸ªç–å¿½ã€‚

## é™æ€ `.create()` å·¥å‚æ–¹æ³•ç§»é™¤

ä¹‹å‰æ‰€æœ‰ Zod ç±»å®šä¹‰äº†é™æ€ `.create()` æ–¹æ³•ã€‚å®ƒä»¬ç°åœ¨ä½œä¸ºç‹¬ç«‹å·¥å‚å‡½æ•°å®ç°ã€‚

```ts
z.ZodString.create(); // âŒ 
```

## `z.record()`

### ç§»é™¤å•å‚æ•°ç”¨æ³•

ä¹‹å‰ `z.record()` å¯ä»¥åªä¼ ä¸€ä¸ªå‚æ•°ã€‚ç°å·²ä¸æ”¯æŒã€‚

```ts
// Zod 3
z.record(z.string()); // âœ…

// Zod 4
z.record(z.string()); // âŒ
z.record(z.string(), z.string()); // âœ…
```

### å¢å¼ºæšä¸¾æ”¯æŒ

Record ç±»å‹æ›´æ™ºèƒ½ã€‚Zod 3 ä¸­ä¼ å…¥æšä¸¾ä½œä¸º key ç±»å‹æ—¶ï¼Œæ¨æ–­ä¸ºéƒ¨åˆ†ç±»å‹ï¼š

```ts
const myRecord = z.record(z.enum(["a", "b", "c"]), z.number()); 
// { a?: number; b?: number; c?: number; }
```

Zod 4 ä¸­ä¸å†æ˜¯éƒ¨åˆ†ç±»å‹ã€‚æ¨æ–­ä¸ºé¢„æœŸç±»å‹ï¼Œä¸” Zod ç¡®ä¿è§£ææ—¶æ‰€æœ‰æšä¸¾é”®å‡å­˜åœ¨ã€‚

```ts
const myRecord = z.record(z.enum(["a", "b", "c"]), z.number());
// { a: number; b: number; c: number; }
```

è¦ä½¿ç”¨å¯é€‰é”®å¤åˆ¶æ—§è¡Œä¸ºï¼Œè¯·ä½¿ç”¨ `z.partialRecord()`ï¼š

```ts
const myRecord = z.partialRecord(z.enum(["a", "b", "c"]), z.number());
// { a?: number; b?: number; c?: number; }
```

## `z.intersection()`

### åˆå¹¶å†²çªæ—¶æŠ›å‡º `Error`

Zod äº¤å‰ç±»å‹å…ˆå°†è¾“å…¥è§£æä¸ºä¸¤ä¸ªæ¨¡å¼ï¼Œç„¶åå°è¯•åˆå¹¶ç»“æœã€‚Zod 3 ä¸­åˆå¹¶å¤±è´¥æ—¶ï¼ŒæŠ›å‡ºå¸¦æœ‰ç‰¹æ®Š `"invalid_intersection_types"` issue çš„ `ZodError`ã€‚

Zod 4 ä¸­åˆ™æŠ›å‡ºæ™®é€š `Error`ã€‚åˆå¹¶å¤±è´¥è¡¨æ˜ schema å­˜åœ¨ç»“æ„æ€§é—®é¢˜ï¼šä¸¤ä¸ªä¸å…¼å®¹ç±»å‹çš„äº¤å‰ã€‚å› æ­¤ï¼ŒæŠ›å‡ºæ™®é€šé”™è¯¯æ¯”éªŒè¯é”™è¯¯æ›´åˆé€‚ã€‚























## å†…éƒ¨æ›´æ–°

> ä¸€èˆ¬ Zod ç”¨æˆ·å¯ä»¥å¿½ç•¥ä»¥ä¸‹å†…å®¹ã€‚è¿™äº›æ›´æ”¹ä¸å½±å“é¢å‘ç”¨æˆ·çš„ `z` APIã€‚

å†…éƒ¨å˜åŠ¨å¾ˆå¤šï¼Œæ— æ³•å…¨éƒ¨åˆ—å‡ºï¼Œä½†å¯¹æŸäº›ï¼ˆæœ‰æ„æˆ–æ— æ„ï¼‰ä¾èµ–å®ç°ç»†èŠ‚çš„ç”¨æˆ·å¯èƒ½ç›¸å…³ã€‚ç‰¹åˆ«å¯¹åŸºäº Zod æ„å»ºå·¥å…·çš„åº“ä½œè€…æœ‰ç”¨ã€‚

### æ³›å‹æ›´æ–°

è‹¥å¹²ç±»çš„æ³›å‹ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œæœ€æ˜¾è‘—çš„æ˜¯ `ZodType` åŸºç±»ï¼š

```ts
// Zod 3
class ZodType<Output, Def extends z.ZodTypeDef, Input = Output> {
  // ...
}

// Zod 4
class ZodType<Output = unknown, Input = unknown> {
  // ...
}
```

ç¬¬äºŒä¸ªæ³›å‹ `Def` è¢«å®Œå…¨ç§»é™¤ã€‚åŸºç±»ä»…è·Ÿè¸ª `Output` ä¸ `Input`ã€‚è¾“å…¥é»˜è®¤å€¼ç”±åŸæ¥çš„ `Output` å˜ä¸º `unknown`ï¼Œè¿™è®©æ¶‰åŠ `z.ZodType` çš„æ³›å‹å‡½æ•°æ›´ç¬¦åˆç›´è§‰ã€‚

```ts
function inferSchema<T extends z.ZodType>(schema: T): T {
  return schema;
};

inferSchema(z.string()); // z.ZodString
```

ä¸å†éœ€è¦ `z.ZodTypeAny`ï¼Œä½¿ç”¨ `z.ZodType` å³å¯ã€‚

### æ–°å¢ `z.core` æ¨¡å—

ä¸ºä¾¿äº Zod ä¸ Zod Mini ä¹‹é—´çš„ä»£ç å…±äº«ï¼Œè¯¸å¤šå®ç”¨å‡½æ•°ä¸ç±»å‹å·²è¿ç§»è‡³æ–°çš„ `zod/v4/core` å­åŒ…ä¸­ã€‚

```ts
import * as z from "zod/v4/core";

function handleError(iss: z.$ZodError) {
  // å¤„ç†é”™è¯¯
}
```

For convenience, the contents of `zod/v4/core` are also re-exported from `zod` and `zod/mini` under the `z.core` namespace. 

```ts
import * as z from "zod";

function handleError(iss: z.core.$ZodError) {
  // å¤„ç†é”™è¯¯
}
```

è¯¦è§ [Zod Core](/packages/core) æ–‡æ¡£äº†è§£æ ¸å¿ƒå­åº“å†…å®¹ã€‚

### ç§»åŠ¨ `._def`

`._def` å±æ€§ç°åœ¨ç§»åŠ¨åˆ° `._zod.def`ã€‚æ‰€æœ‰å†…éƒ¨å®šä¹‰ç»“æ„å¯èƒ½ä¼šå˜ï¼Œä¸»è¦é’ˆå¯¹åº“ä½œè€…ï¼Œæ— è¯¦å°½è¯´æ˜ã€‚

### ç§»é™¤ `ZodEffects`

è¿™ä¸å½±å“ç”¨æˆ· APIï¼Œä½†å€¼å¾—å¼ºè°ƒï¼Œæ˜¯ Zod å¦‚ä½•å¤„ç† *refinements*ï¼ˆç»†åŒ–æ ¡éªŒï¼‰çš„é‡å¤§å†…éƒ¨é‡æ„ã€‚

ä¹‹å‰ï¼Œä¿®é¥°å’Œè½¬æ¢éƒ½å­˜åœ¨äºä¸€ä¸ªåä¸º `ZodEffects` çš„åŒ…è£…ç±»ä¸­ã€‚è¿™æ„å‘³ç€å°†ä»»ä¸€é¡¹æ·»åŠ åˆ°æ¨¡å¼ä¸­ä¼šå°†åŸå§‹æ¨¡å¼åŒ…è£…åœ¨ä¸€ä¸ª `ZodEffects` å®ä¾‹ä¸­ã€‚åœ¨ Zod 4 ä¸­ï¼Œä¿®é¥°ç°åœ¨ç›´æ¥å­˜åœ¨äºæ¨¡å¼å†…éƒ¨ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæ¯ä¸ªæ¨¡å¼åŒ…å«ä¸€ä¸ªâ€œæ£€æŸ¥â€çš„æ•°ç»„ï¼›â€œæ£€æŸ¥â€çš„æ¦‚å¿µåœ¨ Zod 4 ä¸­æ˜¯æ–°çš„ï¼Œå¹¶ä¸”å°†ä¿®é¥°çš„æ¦‚å¿µæ¨å¹¿åˆ°åŒ…æ‹¬å¯èƒ½æœ‰å‰¯ä½œç”¨çš„è½¬æ¢ï¼Œä¾‹å¦‚ `z.toLowerCase()`ã€‚

è¿™åœ¨ Zod Mini API ä¸­å°¤ä¸ºæ˜æ˜¾ï¼Œè¯¥ API å¼ºçƒˆä¾èµ–äº `.check()` æ–¹æ³•æ¥ç»„åˆå„ç§éªŒè¯ã€‚

```ts
import * as z from "zod/mini";

z.string().check(
  z.minLength(10),
  z.maxLength(100),
  z.toLowerCase(),
  z.trim(),
);
```

### æ–°å¢ `ZodTransform`

åŒæ—¶ï¼Œè½¬æ¢ç§»å…¥ä¸“é—¨çš„ `ZodTransform` ç±»ã€‚æ­¤æ¨¡å¼è¡¨ç¤ºè¾“å…¥è½¬æ¢ï¼›å®é™…ä¸Šï¼Œä½ å¯ä»¥å®šä¹‰ç‹¬ç«‹è½¬æ¢ï¼š

```ts
import * as z from "zod";

const schema = z.transform(input => String(input));

schema.parse(12); // => "12"
```

ä¸»è¦ä¸ `ZodPipe` é…åˆä½¿ç”¨ã€‚`.transform()` æ–¹æ³•è¿”å› `ZodPipe` å®ä¾‹ã€‚

```ts
z.string().transform(val => val); // ZodPipe<ZodString, ZodTransform>
```

### ç§»é™¤ `ZodPreprocess`

ä¸ `.transform()` ç±»ä¼¼ï¼Œ`z.preprocess()` ç°åœ¨è¿”å› `ZodPipe`ï¼Œä¸å†æ˜¯ç‹¬ç«‹çš„ `ZodPreprocess`ã€‚

```ts
z.preprocess(val => val, z.string()); // ZodPipe<ZodTransform, ZodString>
```

### ç§»é™¤ `ZodBranded`

Branding ç°åœ¨é€šè¿‡ç›´æ¥ä¿®æ”¹æ¨æ–­ç±»å‹å®ç°ï¼Œæ— ä¸“é—¨çš„ `ZodBranded` ç±»ã€‚å¯¹ç”¨æˆ·çš„ API æ— å½±å“ã€‚

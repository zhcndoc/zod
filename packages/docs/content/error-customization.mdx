---
title: å®šåˆ¶é”™è¯¯
---

import { Tabs, Tab } from 'fumadocs-ui/components/tabs';

{/* ## `$ZodError` */}

åœ¨ Zod ä¸­ï¼ŒéªŒè¯é”™è¯¯ä»¥ `z.core.$ZodError` ç±»çš„å®ä¾‹å½¢å¼å‘ˆç°ã€‚

> `zod/v4` åŒ…ä½¿ç”¨äº†è¯¥ç±»çš„å­ç±»ï¼Œç§°ä¸º `z.ZodError`ï¼Œå®ƒå®ç°äº†ä¸€äº›é¢å¤–çš„ä¾¿æ·æ–¹æ³•ã€‚

`$ZodError` çš„å®ä¾‹åŒ…å« `.issues` æ•°ç»„ã€‚æ¯ä¸ª issue åŒ…å«ä¸€ä¸ªäººç±»å¯è¯»çš„ `message` å’Œå…³äºè¯¥é—®é¢˜çš„å…¶ä»–ç»“æ„åŒ–å…ƒæ•°æ®ã€‚


<Tabs groupId="lib" items={["Zod", "Zod Mini"]}>
<Tab value="Zod">
```ts
import * as z from "zod/v4";

const result = z.string().safeParse(12); // { success: false, error: ZodError }
result.error.issues;
// [
//   {
//     expected: 'string',
//     code: 'invalid_type',
//     path: [],
//     message: 'æ— æ•ˆè¾“å…¥ï¼šé¢„æœŸå­—ç¬¦ä¸²ï¼Œæ”¶åˆ°æ•°å­—'
//   }
// ]
```
</Tab>
<Tab value="Zod Mini">
```ts
import * as z from "zod/v4-mini";

const result = z.string().safeParse(12); // { success: false, error: z.core.$ZodError }
result.error.issues;
// [
//   {
//     expected: 'string',
//     code: 'invalid_type',
//     path: [],
//     message: 'æ— æ•ˆè¾“å…¥'
//   }
// ]
```

</Tab>
</Tabs>

{/* ## å®šåˆ¶åŒ– */}

æ¯ä¸ª issue éƒ½åŒ…å«ä¸€ä¸ªå¸¦æœ‰äººç±»å¯è¯»é”™è¯¯ä¿¡æ¯çš„ `message` å±æ€§ã€‚é”™è¯¯ä¿¡æ¯å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼è‡ªå®šä¹‰ã€‚


## `error` å‚æ•°

å‡ ä¹æ‰€æœ‰ Zod API éƒ½æ¥å—ä¸€ä¸ªå¯é€‰çš„é”™è¯¯æ¶ˆæ¯ã€‚

```ts
z.string("ä¸æ˜¯å­—ç¬¦ä¸²ï¼");
```

è¿™ä¸ªè‡ªå®šä¹‰é”™è¯¯ä¼šä½œä¸ºä»»ä½•æ¥è‡ªè¯¥æ¨¡å¼çš„éªŒè¯é—®é¢˜çš„ `message` å±æ€§æ˜¾ç¤ºã€‚

```ts
z.string("ä¸æ˜¯å­—ç¬¦ä¸²ï¼").parse(12);
// âŒ æŠ›å‡º ZodError {
//   issues: [
//     {
//       expected: 'string',
//       code: 'invalid_type',
//       path: [],
//       message: 'ä¸æ˜¯å­—ç¬¦ä¸²ï¼'   <-- ğŸ‘€ è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯
//     }
//   ]
// }
```

æ‰€æœ‰ `z` å‡½æ•°å’Œæ¨¡å¼æ–¹æ³•å‡æ¥å—è‡ªå®šä¹‰é”™è¯¯ã€‚

<Tabs groupId="lib" items={["Zod", "Zod Mini"]}>
<Tab value="Zod">
```ts
z.string("é”™è¯¯ï¼");
z.string().min(5, "å¤ªçŸ­äº†ï¼");
z.uuid("é”™è¯¯çš„ UUIDï¼");
z.iso.date("æ— æ•ˆæ—¥æœŸï¼");
z.array(z.string(), "ä¸æ˜¯æ•°ç»„ï¼");
z.array(z.string()).min(5, "å…ƒç´ å¤ªå°‘ï¼");
z.set(z.string(), "æ— æ•ˆé›†åˆï¼");
```
</Tab>
<Tab value="Zod Mini">
```ts
z.string("é”™è¯¯ï¼");
z.string().check(z.minLength(5, "å¤ªçŸ­äº†ï¼"));
z.uuid("é”™è¯¯çš„ UUIDï¼");
z.iso.date("æ— æ•ˆæ—¥æœŸï¼");
z.array(z.string(), "é”™è¯¯çš„æ•°ç»„ï¼");
z.array(z.string()).check(z.minLength(5, "å…ƒç´ å¤ªå°‘ï¼"));
z.set(z.string(), "æ— æ•ˆé›†åˆï¼");
```
</Tab>
</Tabs>

å¦‚æœæ„¿æ„ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªåŒ…å« `error` å‚æ•°çš„å¯¹è±¡ã€‚

<Tabs groupId="lib" items={["Zod", "Zod Mini"]}>
<Tab value="Zod">
```ts
z.string({ error: "é”™è¯¯ï¼" });
z.string().min(5, { error: "å¤ªçŸ­äº†ï¼" });
z.uuid({ error: "é”™è¯¯çš„ UUIDï¼" });
z.iso.date({ error: "æ— æ•ˆæ—¥æœŸï¼" });
z.array(z.string(), { error: "é”™è¯¯çš„æ•°ç»„ï¼" });
z.array(z.string()).min(5, { error: "å…ƒç´ å¤ªå°‘ï¼" });
z.set(z.string(), { error: "æ— æ•ˆé›†åˆï¼" });
```
</Tab>
<Tab value="Zod Mini">
```ts
z.string({ error: "é”™è¯¯ï¼" });
z.string().check(z.minLength(5, { error: "å¤ªçŸ­äº†ï¼" }));
z.uuid({ error: "é”™è¯¯çš„ UUIDï¼" });
z.iso.date({ error: "æ— æ•ˆæ—¥æœŸï¼" });
z.array(z.string(), { error: "é”™è¯¯çš„æ•°ç»„ï¼" });
z.array(z.string()).check(z.minLength(5, { error: "å…ƒç´ å¤ªå°‘ï¼" }));
z.set(z.string(), { error: "æ— æ•ˆé›†åˆï¼" });
```

</Tab>
</Tabs>


`error` å‚æ•°ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ã€‚é”™è¯¯å®šåˆ¶å‡½æ•°åœ¨ Zod ä¸­ç§°ä¸º **é”™è¯¯æ˜ å°„ï¼ˆerror mapï¼‰**ã€‚å¦‚æœå‘ç”ŸéªŒè¯é”™è¯¯ï¼Œé”™è¯¯æ˜ å°„ä¼šåœ¨è§£ææ—¶è¿è¡Œã€‚

```ts
z.string({ error: () => `[${Date.now()}]: éªŒè¯å¤±è´¥ã€‚` });
```

<Callout>
**æ³¨æ„** â€” åœ¨ Zod v3 ä¸­ï¼Œ`message`ï¼ˆå­—ç¬¦ä¸²ï¼‰å’Œ `errorMap`ï¼ˆå‡½æ•°ï¼‰æ˜¯åˆ†å¼€çš„å‚æ•°ã€‚å®ƒä»¬åœ¨ Zod 4 ä¸­ç»Ÿä¸€ä¸º `error`ã€‚
</Callout>

é”™è¯¯æ˜ å°„å‡½æ•°æ¥æ”¶ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä½ å¯ä»¥æ ¹æ®éªŒè¯é—®é¢˜è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ã€‚

```ts
z.string({
  error: (iss) => iss.input === undefined ? "è¯¥å­—æ®µä¸ºå¿…å¡«é¡¹ã€‚" : "æ— æ•ˆè¾“å…¥ã€‚"
});
```

å¯¹äºé«˜çº§åœºæ™¯ï¼Œ`iss` å¯¹è±¡æä¾›äº†æ›´å¤šä¿¡æ¯ä¾›ä½ å®šåˆ¶é”™è¯¯ã€‚

```ts
z.string({
  error: (iss) => {
    iss.code; // é—®é¢˜ä»£ç 
    iss.input; // è¾“å…¥æ•°æ®
    iss.inst; // äº§ç”Ÿè¯¥é—®é¢˜çš„æ¨¡å¼/æ£€æŸ¥
    iss.path; // é”™è¯¯è·¯å¾„
  },
});
```

æ ¹æ®ä½ ä½¿ç”¨çš„ APIï¼Œå¯èƒ½ä¼šæœ‰å…¶ä»–å¯ç”¨å±æ€§ã€‚å¯ä»¥ä½¿ç”¨ TypeScript çš„è‡ªåŠ¨è¡¥å…¨æ¢ç´¢è¿™äº›å±æ€§ã€‚

```ts
z.string().min(5, {
  error: (iss) => {
    // ...åŒä¸Š
    iss.minimum; // æœ€å°å€¼
    iss.inclusive; // æ˜¯å¦åŒ…å«æœ€å°å€¼
    return `å¯†ç å¿…é¡»æœ‰è‡³å°‘ ${iss.minimum} ä¸ªå­—ç¬¦`;
  },
});
```

è¿”å› `undefined` å¯é¿å…è®¾ç½®é”™è¯¯æ¶ˆæ¯ã€‚è¿™å¯¹äºåªå®šåˆ¶ç‰¹å®šé”™è¯¯æ¶ˆæ¯è€Œå¿½ç•¥å…¶ä»–æƒ…å†µå¾ˆæœ‰ç”¨ã€‚Zod ä¼šåœ¨[ä¼˜å…ˆçº§é“¾](#é”™è¯¯ä¼˜å…ˆçº§)ä¸­äº¤å‡ºæ§åˆ¶æƒç»™ä¸‹ä¸€ä¸ªé”™è¯¯æ˜ å°„ã€‚

```ts
z.int64({
  error: (issue) => {
    // è¦†ç›– too_big é”™è¯¯æ¶ˆæ¯
    if (issue.code === "too_big") {
      return { message: `å€¼å¿…é¡»å°äº <${issue.maximum}` };
    }

    // ä½¿ç”¨é»˜è®¤é”™è¯¯
    return undefined;
  },
});
```

## é’ˆå¯¹å•æ¬¡è§£æçš„é”™è¯¯å®šåˆ¶

è¦é’ˆå¯¹æ¯æ¬¡è§£æå®šåˆ¶é”™è¯¯ï¼Œå¯ä»¥å‘è§£ææ–¹æ³• `parse` ä¼ å…¥é”™è¯¯æ˜ å°„ï¼š

```ts
const schema = z.string();

schema.parse(12, {
  error: iss => "å•æ¬¡è§£æçš„è‡ªå®šä¹‰é”™è¯¯"
});
```

è¿™æ¯”æ¨¡å¼çº§åˆ«çš„è‡ªå®šä¹‰æ¶ˆæ¯ä¼˜å…ˆçº§*ä½*ã€‚

```ts
const schema = z.string({ error: "æœ€é«˜ä¼˜å…ˆçº§" });
const result = schema.safeParse(12, {
  error: (iss) => "è¾ƒä½ä¼˜å…ˆçº§",
});

result.error.issues;
// [{ message: "æœ€é«˜ä¼˜å…ˆçº§", ... }]
```

`iss` å¯¹è±¡æ˜¯æ‰€æœ‰å¯èƒ½çš„ issue ç±»å‹çš„[åŒºåˆ†è”åˆç±»å‹](https://www.typescriptlang.org/docs/handbook/2/narrowing.html#discriminated-unions)ã€‚ä½¿ç”¨ `code` å±æ€§åŒºåˆ†å®ƒä»¬ã€‚

> è¯¦è§æ‰€æœ‰ Zod issue ä»£ç çš„æ‹†è§£ï¼Œå‚è€ƒ [`zod/v4/core`](/packages/core#issue-types) æ–‡æ¡£ã€‚

```ts
const result = schema.safeParse(12, {
  error: (iss) => {
    if (iss.code === "invalid_type") {
      return `æ— æ•ˆç±»å‹ï¼ŒæœŸæœ› ${iss.expected}`;
    }
    if (iss.code === "too_small") {
      return `æœ€å°å€¼ä¸º ${iss.minimum}`;
    }
    // ...
  }
});
```

### åœ¨ issue ä¸­åŒ…å«è¾“å…¥å€¼

é»˜è®¤æƒ…å†µä¸‹ï¼ŒZod ä¸ä¼šåœ¨ issues ä¸­åŒ…å«è¾“å…¥æ•°æ®ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢æ— æ„ä¸­è®°å½•å¯èƒ½æ•æ„Ÿçš„è¾“å…¥æ•°æ®ã€‚è¦åœ¨æ¯ä¸ª issue ä¸­åŒ…å«è¾“å…¥æ•°æ®ï¼Œè¯·ä½¿ç”¨ `reportInput` æ ‡å¿—ï¼š

```ts
z.string().parse(12, {
  reportInput: true
})

// ZodError: [
//   {
//     "expected": "string",
//     "code": "invalid_type",
//     "input": 12, // ğŸ‘€
//     "path": [],
//     "message": "æ— æ•ˆè¾“å…¥ï¼šé¢„æœŸå­—ç¬¦ä¸²ï¼Œæ”¶åˆ°æ•°å­—"
//   }
// ]
```

## å…¨å±€é”™è¯¯å®šåˆ¶

è¦æŒ‡å®šå…¨å±€é”™è¯¯æ˜ å°„ï¼Œä½¿ç”¨ `z.config()` è®¾ç½® Zod çš„ `customError` é…ç½®é€‰é¡¹ï¼š

```ts
z.config({
  customError: (iss) => {
    return "å…¨å±€ä¿®æ”¹åçš„é”™è¯¯";
  },
});
```

å…¨å±€é”™è¯¯æ¶ˆæ¯çš„ä¼˜å…ˆçº§*ä½äº*æ¨¡å¼çº§åˆ«æˆ–å•æ¬¡è§£æçš„é”™è¯¯æ¶ˆæ¯ã€‚

`iss` å¯¹è±¡æ˜¯æ‰€æœ‰å¯èƒ½çš„ issue ç±»å‹çš„[åŒºåˆ†è”åˆç±»å‹](https://www.typescriptlang.org/docs/handbook/2/narrowing.html#discriminated-unions)ã€‚ä½¿ç”¨ `code` å±æ€§åŒºåˆ†å®ƒä»¬ã€‚

> è¯¦è§æ‰€æœ‰ Zod issue ä»£ç çš„æ‹†è§£ï¼Œå‚è€ƒ [`zod/v4/core`](/packages/core#issue-types) æ–‡æ¡£ã€‚

```ts
const result = schema.safeParse(12, {
  error: (iss) => {
    if (iss.code === "invalid_type") {
      return `æ— æ•ˆç±»å‹ï¼ŒæœŸæœ› ${iss.expected}`;
    }
    if (iss.code === "too_small") {
      return `æœ€å°å€¼ä¸º ${iss.minimum}`;
    }
    // ...
  }
})
```

## å›½é™…åŒ–

ä¸ºæ”¯æŒé”™è¯¯ä¿¡æ¯çš„å›½é™…åŒ–ï¼ŒZod æä¾›äº†å¤šä¸ªå†…ç½®**è¯­è¨€åŒ…ï¼ˆlocalesï¼‰**ã€‚å®ƒä»¬ä» `zod/v4/core` åŒ…å¯¼å‡ºã€‚

> **æ³¨æ„** â€” `zod/v4` åº“è‡ªåŠ¨åŠ è½½ `en` è¯­è¨€åŒ…ã€‚`zod/v4-mini` å­åŒ…ä¸åŠ è½½ä»»ä½•è¯­è¨€åŒ…ï¼Œæ‰€æœ‰é”™è¯¯ä¿¡æ¯é»˜è®¤éƒ½æ˜¯ `Invalid input`ã€‚

<Tabs groupId="lib" items={["Zod", "Zod Mini"]}>
<Tab value="Zod">
```ts
import * as z from "zod/v4";
import en from "zod/v4/locales/en.js"

z.config(en());
```
</Tab>
<Tab value="Zod Mini">
```ts
import * as z from "zod/v4-mini"
import en from "zod/v4/locales/en.js"

z.config(en());
```
</Tab>
</Tabs>

è‹¥æƒ³æ‡’åŠ è½½è¯­è¨€åŒ…ï¼Œå¯ä»¥è€ƒè™‘åŠ¨æ€å¯¼å…¥ï¼š

```ts
import * as z from "zod/v4";

async function loadLocale(locale: string) {
  const { default: locale } = await import(`zod/v4/locales/${locale}.js`);
  z.config(locale());
};

await loadLocale("fr");
```

ä¸ºäº†æ–¹ä¾¿ï¼Œæ‰€æœ‰è¯­è¨€åŒ…ä½œä¸º `z.locales` ä» `zod/v4` å¯¼å‡ºã€‚åœ¨æŸäº›æ‰“åŒ…å™¨ä¸­ï¼Œè¿™å¯èƒ½æ— æ³•è¿›è¡Œæ‘‡æ ‘ä¼˜åŒ–ã€‚

<Tabs groupId="lib" items={["Zod", "Zod Mini"]}>
<Tab value="Zod">
```ts
import * as z from "zod/v4";

z.config(z.locales.en());
```
</Tab>
<Tab value="Zod Mini">
```ts
import * as z from "zod/v4-mini"

z.config(z.locales.en());
```
</Tab>
</Tabs>

### è¯­è¨€åŒ…åˆ—è¡¨

å¯ç”¨è¯­è¨€åŒ…å¦‚ä¸‹ï¼š

- `ar` â€” é˜¿æ‹‰ä¼¯è¯­
- `az` â€” é˜¿å¡æ‹œç–†è¯­
- `be` â€” ç™½ä¿„ç½—æ–¯è¯­
- `ca` â€” åŠ æ³°ç½—å°¼äºšè¯­
- `cs` â€” æ·å…‹è¯­
- `de` â€” å¾·è¯­
- `en` â€” è‹±è¯­
- `es` â€” è¥¿ç­ç‰™è¯­
- `fa` â€” æ³¢æ–¯è¯­
- `fi` â€” èŠ¬å…°è¯­
- `fr` â€” æ³•è¯­
- `frCA` â€” åŠ æ‹¿å¤§æ³•è¯­
- `he` â€” å¸Œä¼¯æ¥è¯­
- `hu` â€” åŒˆç‰™åˆ©è¯­
- `id` â€” å°åº¦å°¼è¥¿äºšè¯­
- `it` â€” æ„å¤§åˆ©è¯­
- `ja` â€” æ—¥è¯­
- `kh` â€” é«˜æ£‰è¯­
- `ko` â€” éŸ©è¯­
- `mk` â€” é©¬å…¶é¡¿è¯­
- `ms` â€” é©¬æ¥è¯­
- `nl` â€” è·å…°è¯­
- `no` â€” æŒªå¨è¯­
- `ota` â€” åœŸè€³å…¶è¯­ï¼ˆæ—§åœŸè€³å…¶è¯­ï¼‰
- `ps` â€” æ™®ä»€å›¾è¯­
- `pl` â€” æ³¢å…°è¯­
- `pt` â€” è‘¡è„ç‰™è¯­
- `ru` â€” ä¿„è¯­
- `sl` â€” æ–¯æ´›æ–‡å°¼äºšè¯­
- `sv` â€” ç‘å…¸è¯­
- `ta` â€” æ³°ç±³å°”è¯­
- `th` â€” æ³°è¯­
- `tr` â€” åœŸè€³å…¶è¯­
- `ua` â€” ä¹Œå…‹å…°è¯­
- `ur` â€” ä¹Œå°”éƒ½è¯­
- `vi` â€” è¶Šå—è¯­
- `zhCN` â€” ç®€ä½“ä¸­æ–‡
- `zhTW` â€” ç¹ä½“ä¸­æ–‡


## é”™è¯¯ä¼˜å…ˆçº§

ä¸‹é¢æ˜¯ç¡®å®šé”™è¯¯ä¼˜å…ˆçº§çš„å¿«é€Ÿå‚è€ƒï¼šå¦‚æœå®šä¹‰äº†å¤šä¸ªé”™è¯¯å®šåˆ¶ï¼Œå“ªä¸ªä¼˜å…ˆï¼ŸæŒ‰*ä»é«˜åˆ°åº•*ä¼˜å…ˆçº§æ’åºï¼š

1. **æ¨¡å¼çº§é”™è¯¯** â€” ä»»ä½•â€œç¡¬ç¼–ç â€åˆ°æ¨¡å¼å®šä¹‰ä¸­çš„é”™è¯¯æ¶ˆæ¯ã€‚

  ```ts
  z.string("ä¸æ˜¯å­—ç¬¦ä¸²ï¼");
  ```

2. **å•æ¬¡è§£æé”™è¯¯** â€” ä¼ å…¥ `.parse()` æ–¹æ³•çš„è‡ªå®šä¹‰é”™è¯¯æ˜ å°„ã€‚

  ```ts
  z.string().parse(12, {
    error: (iss) => "æˆ‘çš„è‡ªå®šä¹‰é”™è¯¯"
  });
  ```

3. **å…¨å±€é”™è¯¯æ˜ å°„** â€” ä¼ ç»™ `z.config()` çš„è‡ªå®šä¹‰é”™è¯¯æ˜ å°„ã€‚

  ```ts
  z.config({
    customError: (iss) => "æˆ‘çš„è‡ªå®šä¹‰é”™è¯¯"
  });
  ```

4. **è¯­è¨€åŒ…é”™è¯¯æ˜ å°„** â€” ä¼ ç»™ `z.config()` çš„è¯­è¨€åŒ…è‡ªå®šä¹‰é”™è¯¯æ˜ å°„ã€‚

  ```ts
  z.config(z.locales.en());
```